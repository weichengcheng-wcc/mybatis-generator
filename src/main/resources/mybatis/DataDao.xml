<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.cw.generator.dao.DataDao">


    <select id="countTables" resultType="java.lang.Integer">
        select count(1) from information_schema.tables where TABLE_SCHEMA = #{db}
        <if test="table != null and table != ''">
            and table_name like concat('%',#{table},'%')
        </if>
    </select>

    <select id="getTables" resultType="com.cw.generator.entity.Table">
        select `TABLE_SCHEMA` as db_name,`engine`, `create_time`,`table_collation` as
        char_set,`table_name`,`table_comment` from information_schema.tables where TABLE_SCHEMA = #{db}
        <if test="table != null and table != ''">
            and table_name like concat('%',#{table},'%')
        </if>
        order by table_name asc limit #{start},#{size}
    </select>

    <select id="getColumns" resultType="com.cw.generator.entity.Column">
        select TABLE_SCHEMA as dbName,TABLE_NAME as tableName,COLUMN_NAME as name,DATA_TYPE as type,COLUMN_COMMENT as
        comment
        from information_schema.columns where TABLE_SCHEMA=#{db} and TABLE_NAME in (
        <foreach collection="tables" item="table" separator=",">
            #{table}
        </foreach>
        )
    </select>

</mapper>
